{% extends 'layout.html' %}

{% block title %}
    Admin Dashboard
{% endblock %}

{% block content %}
<h1 class="display-1">Admin Dashboard</h1>

<!-- Services Table -->
<h2>Services</h2>
<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>ID</th>
            <th>Service Name</th>
            <th>Base Price</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for service in services %}
        <tr>
            <td>{{ service.id }}</td>
            <td>{{ service.name }}</td>
            <td>${{ service.price }}</td>
            <td>
                <a href="{{ url_for('edit_service', service_id=service.id) }}" class="btn btn-primary">
                    <i class="fas fa-edit"></i> Edit
                </a>
                <a href="{{ url_for('delete_service', service_id=service.id) }}" class="btn btn-danger">
                    <i class="fas fa-trash-alt"></i> Delete
                </a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Professionals Table (Pending Approval) -->
<h2>Professionals (Pending Approval)</h2>
<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Experience (Yrs)</th>
            <th>Service Name</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for professional in non_verified_professionals %}
        <tr>
            <td>{{ professional.id }}</td>
            <td>{{ professional.user.username }}</td>
            <td>{{ professional.experience }}</td>
            <td>{{ professional.service_type }}</td>
            <td>
                <a href="{{ url_for('approve_professional', professional_id=professional.user_id) }}" class="btn btn-success">
                    <i class="fas fa-check"></i> Approve
                </a>
                <a href="{{ url_for('reject_professional', professional_id=professional.user_id) }}" class="btn btn-danger">
                    <i class="fas fa-times"></i> Reject
                </a>
                <a href="{{ url_for('delete_professional', professional_id=professional.user_id) }}" class="btn btn-danger">
                    <i class="fas fa-trash-alt"></i> Delete
                </a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Service Requests Table -->
<h2>Service Requests</h2>
<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>ID</th>
            <th>Assigned Professional</th>
            <th>Requested Date</th>
            <th>Status</th>
        </tr>
    </thead>
    <tbody>
        {% for request in service_requests %}
        <tr>
            <td>{{ request.id }}</td>
            <td>{{ request.professional.user.username if request.professional else 'Not Assigned' }}</td>
            <td>{{ request.date_of_request.strftime('%Y-%m-%d') }}</td>
            <td>{{ request.service_status }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<!-- Customer Profiles Table -->
<h2>Customers</h2>
<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Email</th>
            <th>Phone Number</th>
            <th>Address</th>
            <th>Location Pin Code</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for customer in customers %}
        <tr>
            <td>{{ customer.id }}</td>
            <td>{{ customer.user.username }}</td>
            <td>{{ customer.user.email }}</td>
            <td>{{ customer.user.phone_number }}</td>
            <td>{{ customer.address }}</td>
            <td>{{ customer.location_pin_code }}</td>
            <td>
                <a href="{{ url_for('customer_profile', user_id=customer.user_id) }}" class="btn btn-info btn-sm">
                    <i class="fas fa-eye"></i> Details
                </a>
                <a href="{{ url_for('view_reviews', user_id=customer.user_id) }}" class="btn btn-primary btn-sm">
                    <i class="fas fa-eye"></i> Reviews
                </a>
                <a href="{{ url_for('block', user_id=customer.user_id) }}" class="btn btn-danger btn-sm">
                    <i class="fas fa-ban"></i> Block
                </a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Approved Professionals Profiles Table -->
<h2>Professionals</h2>
<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Email</th>
            <th>Phone Number</th>
            <th>Service Type</th>
            <th>Experience (Yrs)</th>
            <th>Verified</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for professional in verified_professionals %}
        <tr>
            <td>{{ professional.id }}</td>
            <td>{{ professional.user.username }}</td>
            <td>{{ professional.user.email }}</td>
            <td>{{ professional.user.phone_number }}</td>
            <td>{{ professional.service_type }}</td>
            <td>{{ professional.experience }}</td>
            <td>{{ 'Yes' if professional.verified else 'No' }}</td>
            <td>
                <a href="{{ url_for('professional_profile', user_id=professional.user_id) }}" class="btn btn-info btn-sm">
                    <i class="fas fa-eye"></i> Details
                </a>
                <a href="{{ url_for('view_reviews', user_id=professional.user_id) }}" class="btn btn-primary btn-sm">
                    <i class="fas fa-eye"></i> Reviews
                </a>
                <a href="{{ url_for('block', user_id=professional.user_id) }}" class="btn btn-danger btn-sm">
                    <i class="fas fa-ban"></i> Block
                </a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>


{% endblock %}


{% block style %}
    
<style>
    .btn-sm {
        padding: 0.25rem 0.5rem; /* Adjust button padding */
        font-size: 0.875rem; /* Adjust font size */
    }
    
    .table {
        table-layout: auto; /* Allow the table to size based on content */
        width: 100%; /* Make the table full width */
    }
    
    td {
        white-space: nowrap; /* Prevent wrapping of table cell content */
    }
    
</style>
{% endblock %}